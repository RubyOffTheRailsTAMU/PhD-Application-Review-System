<% existing = Review.where(user_netid: current_user.user_netid, applicant_id: @result['application_cas_id']) %>
<% condition = ! existing.blank? %>

<%# <%= form_with url: reviews_path, method: :post do |form|%>
<%= form_with url: condition ? review_path(existing.first) : reviews_path, method: condition ? :patch : :post do |form| %>
<div>
    <%= form.label :review_info, "Review:", class: "bold-label" %>
    <%= form.text_area :review_info, size: "50x3", value: condition ? existing.first.review_info : nil %>
</div>
<div>
    <%= form.label :rating, "Rating:", class: "bold-label" %>
    <%# <%= form.select :rating, [1, 2, 3, 4, 5], { include_blank: "Add rating" }, selected: condition ? 4 : nil %>
    <%= form.select :rating, options_for_select([1, 2, 3, 4, 5], condition ? existing.first.rating : nil), { include_blank: "Add rating" }, type: "number" %>
</div>
<div>
    <%= form.hidden_field :user_netid, value: current_user.user_netid %>
    <%# <%= current_user.user_netid %>
    <%= form.hidden_field :applicant_id, value: @result['application_cas_id'] %>
    <%= form.hidden_field :status, value: nil, id: 'status-field' %>
</div>
<div>
    <%= submit_tag "Submit" %>
    <%= submit_tag "Save For Later" %>
</div>
<% end %>